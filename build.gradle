/*
 * Copyright (c) 2025 cpmn.tech
 *
 * Licensed under the MIT License.
 * You may obtain a copy of the License at
 * https://opensource.org/licenses/MIT
 *
 * This file is part of the VulcanTestFramework project.
 * A QA Automation Project by Claudia Paola MuÃ±oz (cpmn.tech)
 */
  
plugins {
    id 'java'
}

group = 'com.vulcan'
version = '0.1.0-SNAPSHOT'

repositories {
    mavenCentral()
}


dependencies {
    // Base test framework (JUnit 4)
    testImplementation 'junit:junit:4.13.2'

    // Selenium WebDriver
    testImplementation 'org.seleniumhq.selenium:selenium-java:4.20.0'

    // Cucumber JVM (Java + JUnit)
    testImplementation 'io.cucumber:cucumber-java:7.15.0'
    testImplementation 'io.cucumber:cucumber-junit:7.15.0'

    // WebDriverManager (automatic driver downloads)
    testImplementation 'io.github.bonigarcia:webdrivermanager:5.7.0'

    // Logging - Log4j2
    testImplementation 'org.apache.logging.log4j:log4j-api:2.24.0'
    testImplementation 'org.apache.logging.log4j:log4j-core:2.24.0'
}

test {
    useJUnit()

    // Allow Gradle to succeed even if no tests are found   
    failOnNoDiscoveredTests = false
    
    // Map all UI + API keys from gradle.properties into System properties
    [
        'ui.baseUrl',
        'ui.browser',
        'ui.implicitWait',
        'api.baseUrl',
        'api.timeout',
        'env'
    ].each { key ->
        if (project.hasProperty(key)) {
            systemProperty key, project.property(key)
        }
    }
    
    // Show test results clearly in console
    testLogging {
        events "PASSED", "FAILED", "SKIPPED"
        showStandardStreams = true
    }

    // Allow filtering test execution by Cucumber tags (optional)
    systemProperty "cucumber.filter.tags", System.getProperty("cucumber.filter.tags")
}